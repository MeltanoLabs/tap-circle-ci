# This file can be used to customize tox tests as well as other test frameworks like flake8 and mypy

[tox]
requires =
    tox>=4.32
env_list =
    format
    3.{10-14}
    lint
skip_missing_interpreters = true

[testenv]
description = run the tests with pytest under {base_python}
package = wheel
pass_env =
    TAP_CIRCLE_CI_*
wheel_build_env = .pkg
dependency_groups =
    test
commands =
    python -m pytest {posargs}

[testenv:format]
description = format the code
deps =
    ruff
commands =
    ruff check --fix tap_circle_ci/
    ruff format tap_circle_ci/

[testenv:lint]
description = lint the code
deps =
    ruff
commands =
    ruff check tap_circle_ci/
    ruff format --check tap_circle_ci/

[testenv:typing]
description = run type check on code base
dependency_groups =
    typing
commands =
    mypy tap_circle_ci tests
    ty check tap_circle_ci tests
